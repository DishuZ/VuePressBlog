<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Linux常见问题 | Zenbu Space</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/blog/assets/img/favicon.ico">
    <meta name="description" content="属于Zenbu的个人博客，持续记录对技术的讲解和梳理学习的知识">
    
    <link rel="preload" href="/blog/assets/css/0.styles.c2eac126.css" as="style"><link rel="preload" href="/blog/assets/js/app.5cf145b8.js" as="script"><link rel="preload" href="/blog/assets/js/2.a59f6ee1.js" as="script"><link rel="preload" href="/blog/assets/js/52.42f15bb0.js" as="script"><link rel="preload" href="/blog/assets/js/9.138ddabb.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.ebdacc7e.js"><link rel="prefetch" href="/blog/assets/js/11.5b92bcb6.js"><link rel="prefetch" href="/blog/assets/js/12.3775846d.js"><link rel="prefetch" href="/blog/assets/js/13.0d25ebcd.js"><link rel="prefetch" href="/blog/assets/js/14.ae1aacae.js"><link rel="prefetch" href="/blog/assets/js/15.96f13d95.js"><link rel="prefetch" href="/blog/assets/js/16.9d928f8a.js"><link rel="prefetch" href="/blog/assets/js/17.53415660.js"><link rel="prefetch" href="/blog/assets/js/18.a4bc894e.js"><link rel="prefetch" href="/blog/assets/js/19.8d81ed15.js"><link rel="prefetch" href="/blog/assets/js/20.26f2bfb0.js"><link rel="prefetch" href="/blog/assets/js/21.4502dce7.js"><link rel="prefetch" href="/blog/assets/js/22.8f5a25ef.js"><link rel="prefetch" href="/blog/assets/js/23.7c5c9567.js"><link rel="prefetch" href="/blog/assets/js/24.ca2c3768.js"><link rel="prefetch" href="/blog/assets/js/25.6d8bbb42.js"><link rel="prefetch" href="/blog/assets/js/26.83039fbb.js"><link rel="prefetch" href="/blog/assets/js/27.adf92751.js"><link rel="prefetch" href="/blog/assets/js/28.f2a024b0.js"><link rel="prefetch" href="/blog/assets/js/29.b3926ca2.js"><link rel="prefetch" href="/blog/assets/js/3.1fcfa166.js"><link rel="prefetch" href="/blog/assets/js/30.40311e72.js"><link rel="prefetch" href="/blog/assets/js/31.c606d6bc.js"><link rel="prefetch" href="/blog/assets/js/32.1a2b64e2.js"><link rel="prefetch" href="/blog/assets/js/33.c9197e3a.js"><link rel="prefetch" href="/blog/assets/js/34.cdcb1225.js"><link rel="prefetch" href="/blog/assets/js/35.dcf7bf36.js"><link rel="prefetch" href="/blog/assets/js/36.ee20ca71.js"><link rel="prefetch" href="/blog/assets/js/37.adc3728f.js"><link rel="prefetch" href="/blog/assets/js/38.b1a60eb1.js"><link rel="prefetch" href="/blog/assets/js/39.254937f1.js"><link rel="prefetch" href="/blog/assets/js/4.c20dd059.js"><link rel="prefetch" href="/blog/assets/js/40.78db51cb.js"><link rel="prefetch" href="/blog/assets/js/41.d9ca5bc7.js"><link rel="prefetch" href="/blog/assets/js/42.ea0a803d.js"><link rel="prefetch" href="/blog/assets/js/43.73b011a9.js"><link rel="prefetch" href="/blog/assets/js/44.bb4d0a8e.js"><link rel="prefetch" href="/blog/assets/js/45.5b12916f.js"><link rel="prefetch" href="/blog/assets/js/46.da1586e9.js"><link rel="prefetch" href="/blog/assets/js/47.d9436699.js"><link rel="prefetch" href="/blog/assets/js/48.0e0875ef.js"><link rel="prefetch" href="/blog/assets/js/49.f37da9a2.js"><link rel="prefetch" href="/blog/assets/js/5.923729f1.js"><link rel="prefetch" href="/blog/assets/js/50.e6807bb8.js"><link rel="prefetch" href="/blog/assets/js/51.279356c7.js"><link rel="prefetch" href="/blog/assets/js/53.c2ee570b.js"><link rel="prefetch" href="/blog/assets/js/54.b05f4789.js"><link rel="prefetch" href="/blog/assets/js/55.0dd0fd5d.js"><link rel="prefetch" href="/blog/assets/js/56.b21f6abc.js"><link rel="prefetch" href="/blog/assets/js/57.7a560703.js"><link rel="prefetch" href="/blog/assets/js/58.729a904b.js"><link rel="prefetch" href="/blog/assets/js/59.9fb40538.js"><link rel="prefetch" href="/blog/assets/js/6.fae665ef.js"><link rel="prefetch" href="/blog/assets/js/60.27a63915.js"><link rel="prefetch" href="/blog/assets/js/61.e309bf9f.js"><link rel="prefetch" href="/blog/assets/js/62.efb2b7de.js"><link rel="prefetch" href="/blog/assets/js/63.6a6d79d0.js"><link rel="prefetch" href="/blog/assets/js/64.12006acb.js"><link rel="prefetch" href="/blog/assets/js/65.8a1adaa8.js"><link rel="prefetch" href="/blog/assets/js/66.3c866e11.js"><link rel="prefetch" href="/blog/assets/js/7.39c6f4a0.js"><link rel="prefetch" href="/blog/assets/js/8.8113b657.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.c2eac126.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container tech-page"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/assets/img/logo.png" alt="Zenbu Space" class="logo"> <span class="site-name can-hide">Zenbu Space</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/blog/" class="nav-link">
  🏠Home
</a></div><div class="nav-item"><a href="/blog/about.html" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/blog/cpp/" class="nav-link">
  C++
</a></div><div class="nav-item"><a href="/blog/java/" class="nav-link">
  ☕Java
</a></div><div class="nav-item"><a href="/blog/algorithm/leetcode100top.html" class="nav-link">
  💫算法
</a></div><div class="nav-item"><a href="/blog/mark_md.html" class="nav-link">
  Markdown
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Liberary Menu" class="dropdown-title"><span class="title">Liberary</span> <span class="arrow down"></span></button> <button type="button" aria-label="Liberary Menu" class="mobile-dropdown-title"><span class="title">Liberary</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/proletarian/" class="nav-link">
  阅读
</a></li><li class="dropdown-item"><!----> <a href="/blog/resource.html" class="nav-link">
  资源
</a></li></ul></div></div> <a href="https://github.com/DishuZ/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/blog/" class="nav-link">
  🏠Home
</a></div><div class="nav-item"><a href="/blog/about.html" class="nav-link">
  About
</a></div><div class="nav-item"><a href="/blog/cpp/" class="nav-link">
  C++
</a></div><div class="nav-item"><a href="/blog/java/" class="nav-link">
  ☕Java
</a></div><div class="nav-item"><a href="/blog/algorithm/leetcode100top.html" class="nav-link">
  💫算法
</a></div><div class="nav-item"><a href="/blog/mark_md.html" class="nav-link">
  Markdown
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Liberary Menu" class="dropdown-title"><span class="title">Liberary</span> <span class="arrow down"></span></button> <button type="button" aria-label="Liberary Menu" class="mobile-dropdown-title"><span class="title">Liberary</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/blog/proletarian/" class="nav-link">
  阅读
</a></li><li class="dropdown-item"><!----> <a href="/blog/resource.html" class="nav-link">
  资源
</a></li></ul></div></div> <a href="https://github.com/DishuZ/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Linux常用命令&amp;问题</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/linux/" aria-current="page" class="sidebar-link">常用命令</a></li><li><a href="/blog/linux/linux_issue.html" aria-current="page" class="active sidebar-link">常见问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#ubuntu-忘记-root-密码" class="sidebar-link">Ubuntu 忘记 root 密码</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#ubuntu-开机显示-you-are-in-emergency-mode-give-root-password-for-maintenance" class="sidebar-link">Ubuntu 开机显示&quot;You are in emergency mode ... Give root password for maintenance&quot;</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#重装系统-ubuntu-server-22-04-lts" class="sidebar-link">重装系统 Ubuntu Server 22.04 LTS</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#第一步-制作启动盘" class="sidebar-link">第一步：制作启动盘</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#第二步-启动主机并开始安装" class="sidebar-link">第二步：启动主机并开始安装</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#遇到的问题" class="sidebar-link">遇到的问题</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#基于-ubuntu-22-04-2-安装显卡" class="sidebar-link">基于 Ubuntu 22.04.2 安装显卡</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#物理安装显卡" class="sidebar-link">物理安装显卡</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#重装系统" class="sidebar-link">重装系统</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#禁用-ubuntu-自带驱动-nouveau" class="sidebar-link">禁用 Ubuntu 自带驱动 nouveau</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#系统连网" class="sidebar-link">系统连网</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#安装-nvidai-驱动" class="sidebar-link">安装 Nvidai 驱动</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#系统分盘" class="sidebar-link">系统分盘</a></li></ul></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#校外-校园网vpn无法访问服务器" class="sidebar-link">校外+校园网VPN无法访问服务器</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#查看当前-sshd-端口" class="sidebar-link">查看当前 sshd 端口</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#修改-ssh-服务配置" class="sidebar-link">修改 ssh 服务配置</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#重启-ssh-服务" class="sidebar-link">重启 ssh 服务</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#验证是否可访问" class="sidebar-link">验证是否可访问</a></li><li class="sidebar-sub-header"><a href="/blog/linux/linux_issue.html#参考-2" class="sidebar-link">参考</a></li></ul></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><div><div><ul id="tag-ul"><li><span>Linux</span></li><li><span>常见问题</span></li></ul></div></div> <hr> <h2 id="ubuntu-忘记-root-密码"><a href="#ubuntu-忘记-root-密码" class="header-anchor">#</a> Ubuntu 忘记 root 密码</h2> <p>忘记 root 密码有两种情况，</p> <ul><li>一种是在安装系统后未设置 root 密码，此时可以直接使用命令 <code>su passwd</code>来设置 root 密码；</li> <li>第二种就是设置了密码但已经忘记了，这个时候只能通过开机进入到 recovery mode 来重新设置 root 密码。</li></ul> <p>那么，<strong>针对第二种</strong>情况，开始解决：</p> <p><strong>1.1 开机</strong></p> <p>开机过程中后进入到 GNU GRUB 界面（有的机器要按住 <code>shift</code>来打开加载 GRUB 的启动界面），这个界面中有好几个选项，选择 <em>Advanced options for Ubuntu</em> 。</p> <p><strong>1.2 设置 recovery mode</strong></p> <p>进入到 _Advanced options for Ubuntu _后，会发现很多选项带有 (recovery mode) 。任选一个，将光标放在其上，但不要回车选择！接着，按 <code>e</code> 进入该选项的编辑命令行，如下图。</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410150700.png" alt="VMWare 虚拟机 Ubuntu 22.4.2 开机界面" class="zoom"> <p>Shift 进入 Recovery mode 后，选择 'root ....' ，出现如图画面</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410151353.png" alt="20240410151353" class="zoom"> <p><strong>/etc/fstab</strong> 文件的用处：<a href="https://blog.csdn.net/weixin_45264425/article/details/126963781" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/weixin_45264425/article/details/126963781<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>Ubuntu 忘记密码</strong> 的一些操作：<a href="https://www.jianshu.com/p/c24c52629bc3" target="_blank" rel="noopener noreferrer">https://www.jianshu.com/p/c24c52629bc3<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>Ubuntu 启动模式介绍</strong>：<a href="https://blog.csdn.net/HandsomeHong/article/details/133950449" target="_blank" rel="noopener noreferrer">https://blog.csdn.net/HandsomeHong/article/details/133950449<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="ubuntu-开机显示-you-are-in-emergency-mode-give-root-password-for-maintenance"><a href="#ubuntu-开机显示-you-are-in-emergency-mode-give-root-password-for-maintenance" class="header-anchor">#</a> Ubuntu 开机显示&quot;You are in emergency mode ... Give root password for maintenance&quot;</h2> <p>这里首先要解决的问题登录 root 账号，若忘记密码了请参考问题1。</p> <p>可以使用 root 密码后，重新开机，查看开机加载日志，中间会出现一个红色的[FAILED]，发现是系统挂载失败，接着就想办法进入Ubuntu系统里寻找挂载失败的原因。</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410151549.png" alt="显示 /Data 目录挂载失败" class="zoom"> <p>...</p> <p>发现是硬盘类型设置错误（这可能是在对硬盘分卷挂载时写错了）</p> <h2 id="重装系统-ubuntu-server-22-04-lts"><a href="#重装系统-ubuntu-server-22-04-lts" class="header-anchor">#</a> 重装系统 Ubuntu Server 22.04 LTS</h2> <h3 id="第一步-制作启动盘"><a href="#第一步-制作启动盘" class="header-anchor">#</a> 第一步：制作启动盘</h3> <ul><li>参考：<a href="https://blog.csdn.net/weixin_49504861/article/details/129343398" target="_blank" rel="noopener noreferrer">制作Ubuntu启动盘并安装ros的学习笔记_ubuntu做启动盘-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>首先去 Ubuntu 官网（<a href="https://ubuntu.com/download/server" target="_blank" rel="noopener noreferrer">https://ubuntu.com/download/server<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）下载镜像，这里我选择下载的是 Ubuntu Server 22.04.2 LTS。</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410151829.png" alt="我这里下载的是 Ubuntu Server 22.04.2 LTS" class="zoom"> <p>接着，需要准备一个U盘（最好是未使用的空U盘），我们要把 Ubuntu .iso文件通过工具刻录到U盘里，做成启动盘。启动盘可以为后续重装系统提供安装引导。</p> <p>在这里，刻录工具选择 Rufus （<a href="https://rufus.ie/zh/" target="_blank" rel="noopener noreferrer">https://rufus.ie/zh/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，下载即用）。先插好U盘，再打开该工具，然后点击“选择”确定你的系统 iso 文件，这样基本准备好了。需要注意的是分区类型，有些旧机子用的是 MBR，而新机子用的是 GPT，根据自己机子的类型来选择（刚开始我装的是 GPT 发现不支持，后面重新烧录改成 MBR ）。然后点击“开始”就可以烧录了，点击后会让你格式化U盘也一并确认。</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410151858.png" alt="Rufus 工具使用界面" class="zoom"> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410151919.png" alt="Rufus 工具使用界面 - 烧录 Ubuntu 22.04" class="zoom"> <p>最后，制作启动盘成功后，就可以把U盘取出来使用了。</p> <h3 id="第二步-启动主机并开始安装"><a href="#第二步-启动主机并开始安装" class="header-anchor">#</a> 第二步：启动主机并开始安装</h3> <ul><li>参考1：<a href="https://www.11343.com/2527.html" target="_blank" rel="noopener noreferrer">Ubuntu 22.04 Server 系统安装图文教程 - 兔子教程<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>参考2：<a href="https://gpu.xuandashi.com/71574.html" target="_blank" rel="noopener noreferrer">ubuntu20.04安装教程分区(ubuntuserver2004安装教程)<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p>现在就要到主机的物理位置地点，把U盘插到主机的USB口上，然后启动机子。如果主机的启动优先项已经是U盘优先，那么这里在启动过程中就会直接进入到GNU GRUB界面或者Ubuntu安装界面，如下图所示。</p> <p>GNU GRUB界面，这里一个多引导装载程序，即计算机启动时运行的软件程序。选择第一项“Try or Install Ubuntu Server”即可进入到Ubuntu安装界面：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410152131.png" alt="GNU GRUB界面，这里一个多引导装载程序，即计算机启动时运行的软件程序。选择第一项“Try or Install Ubuntu Server”即可进入到Ubuntu安装界面" class="zoom"> <p>Ubuntu安装界面，选择语言：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410152209.png" alt="Ubuntu安装界面，选择语言" class="zoom"> <p>后面的步骤就是按照_参考1_来操作，直到最后两个步骤“存储配置”和“个人资料”，按照自己的实际情况填写。“存储配置”即分区，可以根据参考2来自己分。</p> <p>完成最后两个步骤后，系统开始进行配置，最后会告诉你 <code>subiquity/Late/run</code>（不确定是不是大家都是这个样子，这里给出的是我的参考）表示安装完成，如下图所示。选择 “Reboot Now”重启计算机，点击之后接着会提示你拔出U盘，此时再拔出，并且让电脑连网（插网线），这样就顺利安装完成了！</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410152547.png" alt="选择“Reboot Now”，此时还不要拔出U盘" class="zoom"> <h3 id="遇到的问题"><a href="#遇到的问题" class="header-anchor">#</a> 遇到的问题</h3> <p>（1）<code>finish: cmd-in-target: FAIL: curtin command in-target</code></p> <p>这里我操作了好几台机子，在分区后就 error ，还不清楚怎么解决这个问题，错误报告放在下面。</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410152646.png" alt="错误报告" class="zoom"> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410152705.png" alt="错误报告" class="zoom"> <p>在安装系统时不要连网，然后就可以顺利进行下去。</p> <p>（2）<code>media test failure, check cable</code></p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410152734.png" alt="20240410152734" class="zoom"> <div class="custom-block tip"><p class="custom-block-title">UPDATE</p> <p>上面两个问题可能原因是在安装系统时没有断网，参考：<a href="https://www.soinside.com/question/d5NGVP5WwhvX9WYwiYB687" target="_blank" rel="noopener noreferrer">链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></div> <h2 id="基于-ubuntu-22-04-2-安装显卡"><a href="#基于-ubuntu-22-04-2-安装显卡" class="header-anchor">#</a> 基于 Ubuntu 22.04.2 安装显卡</h2> <ul><li><a href="https://www.zhihu.com/question/549057574?utm_id=0" target="_blank" rel="noopener noreferrer">电脑显卡如何安装？ - 知乎<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.52q2.com/Ai_a_21958.html" target="_blank" rel="noopener noreferrer">华为服务器p02报警(华为h22h05服务器参数)-吾爱圈<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/qq_38574198/article/details/131187547" target="_blank" rel="noopener noreferrer">Ubuntu20.04 + 3090 安装nvidia驱动，附加解决重启黑屏卡在 /dev/***: clean, **files,***blocks的问题_ubuntu启动卡在clean_流觞时光的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/weixin_45989883/article/details/129589739?spm=1001.2101.3001.6650.5&amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-5-129589739-blog-133994095.235%5Ev39%5Epc_relevant_anti_vip&amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7ECTRLIST%7ERate-5-129589739-blog-133994095.235%5Ev39%5Epc_relevant_anti_vip&amp;utm_relevant_index=7" target="_blank" rel="noopener noreferrer">ubuntu20.04安装Nvidia驱动后黑屏，无法启动系统_ubuntu20装完显卡驱动黑屏_gz_bro的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/weixin_43387480/article/details/131947497" target="_blank" rel="noopener noreferrer">ubuntu查看显卡驱动_ubuntu 查看显卡驱动-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/u012229282/article/details/124442555" target="_blank" rel="noopener noreferrer">Ubuntu20.04 系统禁用自带的Nouveau驱动_ubuntu禁用nouveau_Coder802的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/u012999810/article/details/120757775" target="_blank" rel="noopener noreferrer">每天十分钟--学透linux --（day1:ubuntu的系统启动过程）_linux查看ubuntu启动时,加载的内核映像文件_maintain001的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/weixin_44044411/article/details/132752621" target="_blank" rel="noopener noreferrer">Ubuntu安装NVIDIA显卡驱动（新手教程）_非线性光学元件的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/yezhijing/article/details/131358170" target="_blank" rel="noopener noreferrer">Ubuntu 22 服务器端安装图形化界面_ubuntu图形界面-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/no1xium/article/details/127012204" target="_blank" rel="noopener noreferrer">我把华为云的Ubuntu 18.04升级到了Ubuntu 22.04_ubuntu18升级到22-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/weixin_49777848/article/details/131684172" target="_blank" rel="noopener noreferrer">基于RTX3090的Ubuntu22.04安装cuda11.7和cudnn8.6_3090 cuda版本_@于千的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/weixin_43301333/article/details/121537145" target="_blank" rel="noopener noreferrer">服务器RTX3090安装显卡驱动,cuda,cudnn,gpu版pytorch记录_3090显卡驱动_Reza.的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://zhuanlan.zhihu.com/p/437334513" target="_blank" rel="noopener noreferrer">RTX 3090配置深度学习环境<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.csdn.net/cwg213_code/article/details/131395846" target="_blank" rel="noopener noreferrer">Ubuntu 20.04-NVIDIA显卡驱动-安装和卸载-解决黑屏问题_ubuntu卸载显卡驱动_山雨空的博客-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <hr> <h3 id="物理安装显卡"><a href="#物理安装显卡" class="header-anchor">#</a> 物理安装显卡</h3> <p><strong>（1）拆卸服务器</strong></p> <p>先把运行的服务器关机，然后拔掉电源，确保在安全的情况下装卸服务器。</p> <p>这里使用的是华为服务器，机盖上有个卡扣，可以一键拆卸服务器，看到主板上的部件。</p> <p><strong>（2）更换服务器供电电源</strong></p> <p>最怕后面忘记更换电源，导致服务器运行显卡后功率不足而炸机。所以，最好是第一步就更换电源，保证服务器供电正常。服务器原始使用的电源是360W的，<strong>需要更换成1200W</strong>，一共有两个电源，记得都要更换。</p> <p>如图，左边的是电源，右边的是显卡槽：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410152856.png" alt="左：电源，右：显卡槽" class="zoom"> <p><strong>（3）安装显卡</strong></p> <p>显卡插入到显卡槽里，然后通过线连接显卡和卡槽，注意把卡槽端端的卡扣先打开，才能把显卡插进去，最后把卡扣合上，伸展板块也对准位置并拧紧。</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410152932.png" alt="显卡" class="zoom"> <p><strong>（4）验证是否安装成功</strong></p> <p>安装好显卡和电源后，把机盖盖好，并安置在机架上，插上电脑，等待开机。</p> <p>开机后，通过命令 <code>lspci | grep -i nvidia</code> 查看是否识别显卡及显卡型号，比如三号机执行该命令的效果如图所示：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153039.png" alt="显示 A5000 显卡，并且有两张" class="zoom"> <p>如果无法显示型号的，通常用4位16进制代码表示，例如 <code>1b06</code>，根据该代码，去<a href="http://pci-ids.ucw.cz/mods/PC/10de?action=help?help=pci" target="_blank" rel="noopener noreferrer">PCI Devices<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>网站上查询对应的显卡型号。</p> <p>如果 <code>lspci | grep -i nvidia</code>命令可以查询到刚刚安装的显卡， 表示服务器识别到了显卡，成功安装。</p> <h3 id="重装系统"><a href="#重装系统" class="header-anchor">#</a> 重装系统</h3> <p>这一步可以按照<a href="#cEmzR">问题3</a>的步骤操作。</p> <h3 id="禁用-ubuntu-自带驱动-nouveau"><a href="#禁用-ubuntu-自带驱动-nouveau" class="header-anchor">#</a> 禁用 Ubuntu 自带驱动 nouveau</h3> <p>（1）先<strong>保持内核</strong>。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 一定要保持当前的内核，也就是安装 NVIDIA 驱动时用的内核</span>
<span class="token function">sudo</span> apt-mark hold linux-image-generic linux-headers-generic
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>（2）然后开始禁用自带的开源驱动 nouveau</p> <p>找到路径 <code>/etc/modprobe.d/</code>，在该目录下<strong>创建新文件</strong> <code>blacklist-nouveau.conf</code>，当然可以用一条命令解决：<code>vim /etc/modprobe.d/blacklist-nouveau.conf</code>，在该（空）文件中添加如下信息：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>blacklist nouveau
options nouveau <span class="token assign-left variable">modeset</span><span class="token operator">=</span><span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>（3）更新并验证是否屏蔽 nouveau</p> <p>更新命令：<code>sudo update-initramfs -u</code></p> <p>然后检查是否屏蔽，命令：<code>lsmod | grep nouveau</code>，<strong>如果没有任何输出，表示成功屏蔽</strong>。</p> <blockquote><p>解读 <code>update-initramfs -u</code>命令：<a href="https://www.python100.com/html/OUEK292Y133A.html" target="_blank" rel="noopener noreferrer">https://www.python100.com/html/OUEK292Y133A.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
在执行该命令前后，可以通过 <code>uname -r</code>查看 Linux 内核版本是否更改。</p></blockquote> <p>（4）重启</p> <p>搞定这一切后，重启 <code>reboot</code>，查看是否可以正常开机，然后可以再验证一遍（3）。</p> <h3 id="系统连网"><a href="#系统连网" class="header-anchor">#</a> 系统连网</h3> <p>首先拿到服务器的 IP，通过 <code>ip -4 a</code>或者 <code>ip add show</code>都可以查看到当前 IP。然后在有网络的电脑上，通过 XShell （或其他远程连接软件）连接服务器。</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153155.png" alt="xshell 连接服务器界面" class="zoom"> <p><strong>情况1：如果要在线安装 Nvidia 驱动，则先联网</strong></p> <p>把校园网登录脚本 cqupt 传入（顺便把 miniconda 也传入安装了），通过脚本连接网络。</p> <p><strong>情况2：如果离线安装 Nvidia 驱动，可以不联网</strong></p> <p>略</p> <h3 id="安装-nvidai-驱动"><a href="#安装-nvidai-驱动" class="header-anchor">#</a> 安装 Nvidai 驱动</h3> <p><strong>（1）卸载原有驱动</strong></p> <p>如果是重装的系统，应该是不存在 nvidia 驱动的，因此该步骤选做。</p> <p><code>sudo apt-get --purge remove nvidia*</code> 卸载已经安装的 Nvidia 驱动。</p> <p><strong>（2）更新软件列表</strong></p> <p>首先可以先更新一下软件源 <code>sources.list</code>，这个步骤也可以在重新系统时先设定好。先备份 <code>cp /etc/apt/sources.list /etc/apt/sources.list.bak</code>，然后编辑 <code>vim /etc/apt/sources.list</code>，更换成阿里源/中科大源/清华源其中之一，下面分别为三者的软件源：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># 阿里源</span>
deb http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-security main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-updates main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src http://mirrors.aliyun.com/ubuntu/ bionic-backports main restricted universe multiverse

<span class="token comment"># 中科大源</span>
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
deb https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
deb-src https://mirrors.ustc.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse


<span class="token comment">### 清华源 https://mirror.tuna.tsinghua.edu.cn/help/ubuntu/</span>

<span class="token comment"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy main restricted universe multiverse</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-updates main restricted universe multiverse</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-backports main restricted universe multiverse</span>

deb http://security.ubuntu.com/ubuntu/ jammy-security main restricted universe multiverse
<span class="token comment"># deb-src http://security.ubuntu.com/ubuntu/ jammy-security main restricted universe multiverse</span>

<span class="token comment"># 预发布软件源，不建议启用</span>
<span class="token comment"># deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse</span>
<span class="token comment"># # deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ jammy-proposed main restricted universe multiverse</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br></div></div><p>编辑后保存。</p> <p>然后再更新软件：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> update
<span class="token comment"># 下面这三个不一定要操作</span>
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> g++  
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> gcc
<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">make</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>三号机上的软件源：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># See http://help.ubuntu.com/community/UpgradeNotes for how to upgrade to</span>
<span class="token comment"># newer versions of the distribution.</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy main restricted
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy main restricted</span>

<span class="token comment">## Major bug fix updates produced after the final release of the</span>
<span class="token comment">## distribution.</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-updates main restricted
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-updates main restricted</span>

<span class="token comment">## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu</span>
<span class="token comment">## team. Also, please note that software in universe WILL NOT receive any</span>
<span class="token comment">## review or updates from the Ubuntu security team.</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy universe
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy universe</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-updates universe
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-updates universe</span>

<span class="token comment">## N.B. software from this repository is ENTIRELY UNSUPPORTED by the Ubuntu</span>
<span class="token comment">## team, and may not be under a free licence. Please satisfy yourself as to</span>
<span class="token comment">## your rights to use the software. Also, please note that software in</span>
<span class="token comment">## multiverse WILL NOT receive any review or updates from the Ubuntu</span>
<span class="token comment">## security team.</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy multiverse
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy multiverse</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-updates multiverse
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-updates multiverse</span>

<span class="token comment">## N.B. software from this repository may not have been tested as</span>
<span class="token comment">## extensively as that contained in the main release, although it includes</span>
<span class="token comment">## newer versions of some applications which may provide useful features.</span>
<span class="token comment">## Also, please note that software in backports WILL NOT receive any review</span>
<span class="token comment">## or updates from the Ubuntu security team.</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-backports main restricted universe multiverse
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-backports main restricted universe multiverse</span>

deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-security main restricted
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-security main restricted</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-security universe
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-security universe</span>
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-security multiverse
<span class="token comment"># deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu jammy-security multiverse</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br></div></div><p><strong>（3）查看 Nvidia 驱动版本并安装</strong></p> <p>查看当前服务器属性：<code>ubuntu-drivers devices</code>，这里会显示推荐的驱动版本，标识 <code>recommended</code>，即为合适的驱动。</p> <p>接下来有两种方式安装驱动。</p> <p>方法1：离线安装。在<a href="https://download.nvidia.com/XFree86/Linux-x86_64/" target="_blank" rel="noopener noreferrer">镜像站<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>中找到想要下载的版本，在电脑上下载，然后上传到服务器，再通过如下命令安装：<code>bash NVIDIA-Linux-x86_64-xxx.run</code>，加上参数 <code>--np-opengl-files</code>保证只安装驱动文件。</p> <p>方法2：直接安装。通过命令 <code>sudo apt-get install nvidia-driver-525</code>。</p> <p>安装好之后，也可以执行（也可以不执行，验证失败时再尝试）下面这条指令，表示加载驱动模块：<code>sudo modprobe nvidia</code></p> <p><a href="https://blog.csdn.net/xiao_xian_/article/details/132415898" target="_blank" rel="noopener noreferrer">【error】nvidia-smi无效的解决策略_modprobe: error: could not insert ‘nvidia’: operat-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>（4）验证安装结果</strong></p> <p>之后用 <code>nvidia-smi</code> 命令，查看驱动是否安装好。</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153405.png" alt="20240410153405" class="zoom"> <hr> <h3 id="系统分盘"><a href="#系统分盘" class="header-anchor">#</a> 系统分盘</h3> <h4 id="整体流程"><a href="#整体流程" class="header-anchor">#</a> 整体流程</h4> <p>分盘的整体流程：PV -&gt; VG -&gt; LG -&gt; mount，如图：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153505.png" alt="分盘的整体流程：PV -&gt; VG -&gt; LG -&gt; mount" class="zoom"> <p>这是未操作前的挂载情况：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153544.png" alt="20240410153544" class="zoom"> <h4 id="创建卷组"><a href="#创建卷组" class="header-anchor">#</a> 创建卷组</h4> <p>创建卷组，卷组情况：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153607.png" alt="物理卷和卷组的创建过程" class="zoom"> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153627.png" alt="最终的卷组情况" class="zoom"> <h4 id="创建逻辑卷-挂载"><a href="#创建逻辑卷-挂载" class="header-anchor">#</a> 创建逻辑卷&amp;挂载</h4> <p><strong>1）从卷组 <code>vg0</code> 中分配空间来创建逻辑卷 <code>lgData</code> 和 <code>lgHome</code></strong></p> <p>创建逻辑卷，逻辑卷情况：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153724.png" alt="基于卷组 vg0 创建逻辑卷" class="zoom"> <p><strong>2）逻辑卷创建好后，需要格式化成  <code>ext4</code>  ，然后再挂载（ <code>mount</code> ）到目录</strong></p> <p>格式化和挂载：</p> <p>挂载逻辑卷 lgData 到 /Data：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153802.png" alt="挂载逻辑卷 lgData 到 /Data" class="zoom"> <p>挂载逻辑卷 lgHome 到 /home，需要迂回一下：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153824.png" alt="挂载逻辑卷 lgHome 到 /home，需要迂回一下" class="zoom"> <h4 id="开机自动挂载"><a href="#开机自动挂载" class="header-anchor">#</a> 开机自动挂载</h4> <p>挂载操作只会在系统运行期间生效，如果系统重启，那么就会失效。因此需要设置一下文件<code>/etc/fstab</code>，使其可以做到开机自动挂载。</p> <p>设置开机自动挂载：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153902.png" alt="vim /etc/fstab" class="zoom"> <p>最终情况：</p> <img src="https://raw.gitmirror.com/DishuZ/PicGo/main/all/20240410153920.png" alt="20240410153920" class="zoom"> <h4 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h4> <ul><li><a href="https://blog.csdn.net/weixin_43693967/article/details/128033305" target="_blank" rel="noopener noreferrer">【linux】逻辑卷、lvm2使用、ubuntu将多个硬盘挂载到一个目录_linuxlvm挂载到目录-CSDN博客<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://blog.51cto.com/beyang/6037380" target="_blank" rel="noopener noreferrer">ubuntu 的 LVM 逻辑卷_51CTO博客_在ubuntu新安装中使用lvm<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="校外-校园网vpn无法访问服务器"><a href="#校外-校园网vpn无法访问服务器" class="header-anchor">#</a> 校外+校园网VPN无法访问服务器</h2> <div class="custom-block tip"><p class="custom-block-title">解决方法</p> <p>需要将 sshd 的端口设置为 5122，具体原理不太清楚（有可能是学校在哪里设置了不允许22端口通过）</p></div> <h3 id="查看当前-sshd-端口"><a href="#查看当前-sshd-端口" class="header-anchor">#</a> 查看当前 sshd 端口</h3> <p>先查看当前监听端口 <code>ss -tuln</code> / <code>ss -tulnp | grep sshd</code></p> <h3 id="修改-ssh-服务配置"><a href="#修改-ssh-服务配置" class="header-anchor">#</a> 修改 ssh 服务配置</h3> <p>修改 ssh 配置文件 <code>vim /etc/ssh/sshd_config</code>，把文件里的 <code>#Port 22</code> 前面的注释去掉，改成：</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>Port <span class="token number">5122</span>
Port <span class="token number">22</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div><div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>同时添加 22 和 5122 两个端口，以免端口添加失败，导致自己无法远程登录服务器。</p> <h3 id="重启-ssh-服务"><a href="#重启-ssh-服务" class="header-anchor">#</a> 重启 ssh 服务</h3> <p>重启 ssh 命令：<code>systemctl restart sshd.service</code></p> <h3 id="验证是否可访问"><a href="#验证是否可访问" class="header-anchor">#</a> 验证是否可访问</h3> <p>一方面，通过 <code>ss -tulnp | grep sshd</code> 再次查看监听端口，可以看到多了 5122 的监听；
另一方面，尝试通过“校外+校园网VPN”的方式连接服务器（端口号5122），发现确实可以访问了。</p> <h3 id="参考-2"><a href="#参考-2" class="header-anchor">#</a> 参考</h3> <ul><li><a href="http://m.blog.chinaunix.net/uid-12357721-id-5817224.html" target="_blank" rel="noopener noreferrer">http://m.blog.chinaunix.net/uid-12357721-id-5817224.html<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/linux/" class="prev router-link-active">
        常用命令
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/blog/assets/js/app.5cf145b8.js" defer></script><script src="/blog/assets/js/2.a59f6ee1.js" defer></script><script src="/blog/assets/js/52.42f15bb0.js" defer></script><script src="/blog/assets/js/9.138ddabb.js" defer></script>
  </body>
</html>
